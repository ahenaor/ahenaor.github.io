[{"content":"AWS Lambda es un servicio que permite ejecutar código sin preocuparnos por la infraestructura de los servidores donde corren -Serverless-. Esto lo convierte en un servicio muy potente y práctico para implementar una gran variedad de proyectos.\nAWS Lambda es compatible de forma nativa con Java, Go, PowerShell, Node.js, C#, Python y Ruby.\nAWS Lambda incluye los módulos integrados en la versión de Python que despliegues (2.7, 3.6, 3.7, 3.8 o 3.9) como por ejemplo json. Adicionalmente, incluye boto3 ya que es la librería oficial de AWS para las integraciones de nuestras aplicaciones en Python con los servicios de AWS como S3, EC2, DynamoDB entre otros.\nTiempos de ejecución de Python    Nombre AWS SDK Sistema Operativo Arquitecturas     python3.9 boto3-1.18.55 botocore-1.21.55 Amazon Linux 2 x86_64, arm64   python3.8 boto3-1.18.55 botocore-1.21.55 Amazon Linux 2 x86_64, arm64   python3.7 boto3-1.18.55 botocore-1.21.55 Amazon Linux x86_64   python3.6 boto3-1.18.55 botocore-1.21.55 Amazon Linux x86_64   python2.7 boto3-1.17.100 botocore-1.20.100 Amazon Linux x86_64    Fuente: AWS\nEvidentemente, en la gran mayoría de los casos de uso de funciones Lambda con Python, vamos a requerir utilizar librerías externas que nos ayuden a codificar la lógica de nuestra función.\nEn este ejemplo práctico, vamos a aprovisionar una función Lambda para ejecutarse con Python 3.9 incluyendo la librería pandas. Lo primero que debemos hacer es crear la función Lambda a través de la interfaz de consola de AWS:\n Seleccione la opción de “Comience con un ejemplo simple de Hello World”. Escriba un nombre apropiado para su función Lambda. Seleccione el runtime Python 3.9. Seleccione la arquitectura x86_64. En permisos seleccione la opción “Cree un nuevo rol con permisos básicos de Lambda”. Clic en el botón Create functions.  Luego, debemos preparar una capa de Python con librería Pandas:\nLa librería pandas es un potente kit de herramientas de análisis de datos de Python. Cuando se instala pandas, de manera automática el sistema instala otras dependencias de pandas como lo son pytz, python-dateutil y numpy.\nCon Numpy pasa un caso particular y es que su compilación deber ser exactamente igual a la máquina en la que se va a ejecutar. Si revisamos el cuadro donde vemos las características de cada runtime de Python vemos que la versión 3.9 se va a ejecutar en Lambda en un sistema operativo Amazon Linux 2. Por tanto es necesario que numpy sea compilado en una máquina igual.\nPara resolver esto, lo que vamos a hacer es:\n  Crear una instancia de EC2 con Amazon Linux 2.\n  En la EC2 Instalar Python 3.9 - Podemos seguir esta guía\n  Instalar virtualenv\npip3.9 install virtualenv\n  Crear un directorio, por ejemplo: compilacion-pandas y allí crear un entorno virtual.\nvirtualenv venv\nsource venv/bin/activate\n  Instalar pandas\npip3.9 install pandas\n  Copiar lib o lib64 a un directorio llamado python.\ncp -r /home/ec2-user/pandas/venv/lib64 /home/ec2-user/pandas/venv/python\n  Renombrar lib64 a lib\nmv lib64 lib\n  Ir a la raiz de la instancia e instalar AWS CLI\ncurl \u0026quot;https://awscli.amazonaws.com/awscli-exe-linux-x86_64.zip\u0026quot; -o \u0026quot;awscliv2.zip\u0026quot; unzip awscliv2.zip sudo ./aws/install\n  Eliminar basura, comprimir en .zip la carpeta python y enviarla a S3\nrm -r *.whl *.dist-info __pycache__\nzip -r9 pandas39.zip python\naws s3 cp pandas39.zip s3://bucket-0574-base\n  En este punto ya tenemos en S3 nuestro .zip con pandas compilado en una máquina Amazon Linux 2.\nAhora lo úlitmo que debemos hacer es ir ala función Lambda y en el apartado Layers crear un nuevo Layer compatible con el rumtime Python 3.9 y la arquitectura x86_64 y finalmente cargamos el .zip desde S3.\nRecursos complementarios:  AWS - How do I resolve the \u0026ldquo;Unable to import module\u0026rdquo; error that I receive when I run Lambda code in Python? AWS - Creating and sharing Lambda layers AWS - Building Lambda functions with Python AWS - Installing or updating the latest version of the AWS CLI Medium - AWS Lambda with Pandas and NumPy TechView - How To Install Python 3.10 on Amazon Linux 2  gitconnected - Implementación en AWS Lambda: Python + Layers + CloudWatc  Ideas sueltas:  Es fundamental aprender a realizar esta misma configuración pero desde el enfoque de infraestructura como código.  ","permalink":"https://ahenaor.github.io/til/configurar-lambda-runtime-python39/","summary":"AWS Lambda es un servicio que permite ejecutar código sin preocuparnos por la infraestructura de los servidores donde corren -Serverless-. Esto lo convierte en un servicio muy potente y práctico para implementar una gran variedad de proyectos.\nAWS Lambda es compatible de forma nativa con Java, Go, PowerShell, Node.js, C#, Python y Ruby.\nAWS Lambda incluye los módulos integrados en la versión de Python que despliegues (2.7, 3.6, 3.7, 3.8 o 3.","title":"Cómo configurar una función Lambda para ejecutarse con Runtime Python 3.9 con pandas"},{"content":"Politólogo de la Universidad Nacional de Colombia. Durante más de 10 años trabajé en diferentes proyectos analíticos con enfoque social en roles de ejeución, monitoreo y evaluación para empresas privadas, organizaciones no gubernamentales e Instituciones de Educación Superior.\nEntre 2019 y 2020 cursé una especialización en Gestión y Seguridad en Bases de Datos y participé en varios proyectos educativos con un enfoque central en datos.\nEntre 2020 y 2021 cursé otra especialización en analítica de datos y comencé a trabajar a tiempo completo en la industria TECH; específicamente en una Agencia de Publicidad Digital donde estuve desempeñando el cargo de Analista de Base de Datos entre el 2020 y 2021.\nA mediados de 2021, fuí reclutado por una Fintech que presta servicios SERVERLESS y actualmente trabajo allí como Ingeniero de Datos.\nMis intereses profesionales giran en torno a soluciones basadas en datos bajo tecnologías y ambientes tales como :\n Python SQL AWS AZURE BI Open Data Open Source  ","permalink":"https://ahenaor.github.io/about/","summary":"Politólogo de la Universidad Nacional de Colombia. Durante más de 10 años trabajé en diferentes proyectos analíticos con enfoque social en roles de ejeución, monitoreo y evaluación para empresas privadas, organizaciones no gubernamentales e Instituciones de Educación Superior.\nEntre 2019 y 2020 cursé una especialización en Gestión y Seguridad en Bases de Datos y participé en varios proyectos educativos con un enfoque central en datos.\nEntre 2020 y 2021 cursé otra especialización en analítica de datos y comencé a trabajar a tiempo completo en la industria TECH; específicamente en una Agencia de Publicidad Digital donde estuve desempeñando el cargo de Analista de Base de Datos entre el 2020 y 2021.","title":"Acerca de mi"}]